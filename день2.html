<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Розклад</title>
<!--   <link type="text/css" rel="stylesheet" href="sheet.css"> -->
 <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<style>
  @font-face {
    font-family: 'PP Pangram Sans';
    src: url('PPPangramSans-Semibold.otf') format('opentype');
    font-weight: 600;
    font-style: normal;
  }

  @font-face {
    font-family: 'PP Pangram Sans';
    src: url('PPPangramSans-Bold.otf') format('opentype');
    font-weight: 700;
    font-style: normal;
  }

  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background-color: #000000; /* чорний фон */
    color: rgb(255, 167, 34);
    font-family: 'PP Pangram Sans', Arial, sans-serif;
    overflow-x: hidden;
    overflow-y: hidden;
  }

  .ritz.grid-container {
    height: 100vh;
    max-width: 100vw;
    margin: 0 auto;
    padding: 10px;
    box-sizing: border-box;
    overflow-y: auto;
  }

  .ritz .waffle-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    width: 100%;
  }

  .ritz .waffle {
    border-collapse: collapse;
    width: 100%;
    table-layout: auto;
    white-space: normal;
  }

  /* Приховуємо колонку з номерами рядків */
  .ritz .waffle th.row-headers-background,
  .ritz .waffle td.row-headers-background {
    display: none;
  }

  .ritz .waffle th,
  .ritz .waffle td {
    border: 2px solid rgb(255, 136, 25);
    padding: 6px;
    text-align: center;
    vertical-align: middle;
    white-space: normal;
    word-break: normal;
    overflow-wrap: break-word;
    max-width: none;
  }

  .current-time {
    background-color: rgba(176, 6, 0, 0.49);
  }

  .highlight {
    background-color: rgba(255, 21, 0, 0.3);
    transition: background-color 0.3s ease;
  }

  .manual-highlight {
    background-color: rgba(255, 26, 26, 0.341);
    transition: background-color 0.3s ease;
  }

  .artist-highlight {
    background-color: rgba(255, 100, 34, 0.234);
    outline: 1px solid rgba(255, 165, 0, 0.7);
    transition: background-color 0.3s ease;
  }

  .artist-highlight.active {
    background-color: rgba(255, 26, 26, 0.341);
    font-weight: 600;
  }

  /* Новий клас для жирного часу при виборі рядка часу */
  .time-highlight-active {
    font-weight: 600;
    color: orange;
  }
</style>


</head>
<body>
  <div class="ritz grid-container" dir="ltr">
    <div class="waffle-container">
     <table class="waffle" cellspacing="0" cellpadding="0">
        <tbody>
            <tr style="height: 55px">
                <th id="138073132R0" style="height: 55px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 55px">1</div>
                </th>
                <td class="s0"></td>
                <td class="s0">Двір</td>
                <td class="s0">Ангар</td>
                <td class="s0">Парковка</td>
                <td class="s0">Дача</td>
                <td class="s0">Keller</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R1" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">2</div>
                </th>
                <td class="s1">14:00</td>
                <td class="s2" rowspan="2"></td>
                <td class="s2" rowspan="2"></td>
                <td class="s2" rowspan="5"></td>
                <td class="s3" rowspan="3">VALERIA OBODZINSKA</td>
                <td class="s2" rowspan="2"></td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R2" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">3</div>
                </th>
                <td class="s1">14:30</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R3" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">4</div>
                </th>
                <td class="s1">15:00</td>
                <td class="s3" rowspan="2">FUJI MOODJI</td>
                <td class="s3" rowspan="3">MAKS YOS (LIVE)</td>
                <td class="s3">OLEKSII PODAT (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R4" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">5</div>
                </th>
                <td class="s1">15:30</td>
                <td class="s3">ACID MAMBA</td>
                <td class="s3" rowspan="2">MARYANA KLOCHKO (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R5" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">6</div>
                </th>
                <td class="s1">16:00</td>
                <td class="s3" rowspan="2">PROVULOK</td>
                <td class="s3">ТУЛИМ &amp; ZOMBO</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R6" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">7</div>
                </th>
                <td class="s1">16:30</td>
                <td class="s3">DOCTOR BUGG (LIVE)</td>
                <td class="s3" rowspan="2">G. INC</td>
                <td class="s3" rowspan="2">LIGHT DREAMS (LIVE)</td>
                <td class="s3">EREH SAW (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R7" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">8</div>
                </th>
                <td class="s1">17:00</td>
                <td class="s3" rowspan="2">OI FUSK</td>
                <td class="s3" rowspan="2">HUMAN MARGAREETA (HYBRID LIVE)</td>
                <td class="s3" rowspan="2">DEEAITCH (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R8" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">9</div>
                </th>
                <td class="s1">17:30</td>
                <td class="s3">СКАЛО (LIVE)</td>
                <td class="s3" rowspan="2">KBT (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R9" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">10</div>
                </th>
                <td class="s1">18:00</td>
                <td class="s3" rowspan="2">CHUBAREENEE</td>
                <td class="s3" rowspan="2">MAAT (LIVE)</td>
                <td class="s3">SOBAKKA</td>
                <td class="s3" rowspan="2">KATIA STIEBER</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R10" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">11</div>
                </th>
                <td class="s1">18:30</td>
                <td class="s3" rowspan="2">ГЕКСЕН</td>
                <td class="s3" rowspan="3">LUSCHN B2B LISOVSKYI</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R11" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">12</div>
                </th>
                <td class="s1">19:00</td>
                <td class="s3" rowspan="2">ВИСТАВКА ДИСТОРШН</td>
                <td class="s3" rowspan="2">SI PROCESS (LIVE)</td>
                <td class="s3" rowspan="2">VH10 (LIVE)</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R12" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">13</div>
                </th>
                <td class="s1">19:30</td>
                <td class="s3">BOANTHROPY</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R13" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">14</div>
                </th>
                <td class="s1">20:00</td>
                <td class="s3" rowspan="2">HYPHEN DASH</td>
                <td class="s3" rowspan="2">SOMINARYST</td>
                <td class="s3">THE VASGEN</td>
                <td class="s3" rowspan="5">ALEX SAVAGE B2B BORYS</td>
                <td class="s3" rowspan="2">OSTAP OLEKSYN</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R14" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">15</div>
                </th>
                <td class="s1">20:30</td>
                <td class="s3" rowspan="2">MORDOX</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R15" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">16</div>
                </th>
                <td class="s1">21:00</td>
                <td class="s3" rowspan="3">СТАС КОРОЛЬОВ</td>
                <td class="s3" rowspan="3">VANYA BIOS B2B DJ KRITSKY</td>
                <td class="s3" rowspan="3">OLES</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R16" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">17</div>
                </th>
                <td class="s1">21:30</td>
                <td class="s3" rowspan="2">TELEMA</td>
            </tr>
            <tr style="height: 20px">
                <th id="138073132R17" style="height: 20px;" class="row-headers-background">
                    <div class="row-header-wrapper" style="line-height: 20px">18</div>
                </th>
                <td class="s1">22:00</td>
            </tr>
        </tbody>
    </table>
  </div>
    </div>

<script>
  // === CONFIGURATION ===
  const timeZone = 'Europe/Kyiv';
  // === CONFIGURATION FOR THE DAY ===
  // Change this value for each file. Use 14 for день1.html and 15 for день2.html
  const scheduleDay = 15;

  // We check the date on page load to see if we should activate auto-highlighting.
  const pageLoadTime = new Date(new Date().toLocaleString('en-US', { timeZone }));
  const day = pageLoadTime.getDate();
  const month = pageLoadTime.getMonth() + 1;
  const year = pageLoadTime.getFullYear();
  const isFestivalDay = day === scheduleDay && month === 6 && year === 2025;

  /**
   * Gets the current time in Kyiv, rounded to the nearest half hour (e.g., "14:00" or "14:30").
   * This is called when highlighting, so it's always live.
   */
  function getCurrentTimeRoundedHalfHour() {
    const now = new Date(new Date().toLocaleString('en-US', { timeZone }));
    const hours = now.getHours();
    const minutes = now.getMinutes();
    const roundedMinutes = minutes < 30 ? '00' : '30';
    return `${hours.toString().padStart(2, '0')}:${roundedMinutes}`;
  }

  /**
   * Clears all highlights and styles applied by manual user clicks.
   * It is designed to NOT remove the automatic time highlight.
   */
  function clearAllHighlights() {
    // Remove all classes associated with manual highlighting
    document.querySelectorAll('.manual-highlight, .artist-highlight, .active, .time-highlight-active')
      .forEach(cell => cell.classList.remove('manual-highlight', 'artist-highlight', 'active', 'time-highlight-active'));

    // The .highlight class is used for both auto and manual highlighting.
    // We only remove it from cells that are NOT marked as auto-highlighted.
    document.querySelectorAll('.highlight:not(.auto-highlight)').forEach(cell => {
      cell.classList.remove('highlight');
      cell.style.fontWeight = ''; // Reset font weight for previously highlighted cells
    });
  }

  /**
   * Finds the current timeslot in the table and applies automatic highlighting.
   * This highlight is preserved during manual clicks.
   */
  function highlightCurrentTime() {
    // First, clear any existing auto-highlights to handle time changes.
    document.querySelectorAll('.auto-highlight').forEach(cell => {
        cell.classList.remove('highlight', 'auto-highlight');
        cell.style.fontWeight = '';
    });

    const currentTime = getCurrentTimeRoundedHalfHour();
    const hour = parseInt(currentTime.split(':')[0], 10);

    // Exit if the current time is outside the festival's active hours (14:00 - 22:00)
    if (hour < 14 || hour >= 22) return;

    const targetCell = Array.from(document.querySelectorAll('.s1'))
      .find(cell => cell.textContent.trim() === currentTime);

    if (targetCell) {
      const table = document.querySelector('.waffle');
      const rows = Array.from(table.rows);
      const rowIndex = rows.indexOf(targetCell.parentElement);

      const applyHighlight = (cell) => {
        if (getComputedStyle(cell).display !== 'none') {
          cell.classList.add('highlight', 'auto-highlight');
          cell.style.fontWeight = 'bold';
        }
      };

      // Highlight the row itself
      rows[rowIndex].querySelectorAll('td, th').forEach(applyHighlight);

      // Highlight cells with rowspan that span across the current time row
      rows.forEach((row, rIdx) => {
        Array.from(row.cells).forEach(cell => {
          const rowspan = parseInt(cell.getAttribute('rowspan') || '1');
          if (rowspan > 1) {
            const start = rIdx;
            const end = rIdx + rowspan - 1;
            if (rowIndex >= start && rowIndex <= end) {
              applyHighlight(cell);
            }
          }
        });
      });
    }
  }

  /**
   * Highlights the entire row and corresponding artists when a time cell is clicked.
   * @param {HTMLElement} clickedCell The time cell that was clicked.
   */
  function highlightManualTimeRow(clickedCell) {
    const table = document.querySelector('.waffle');
    const rows = Array.from(table.rows);
    const rowIndex = rows.indexOf(clickedCell.parentElement);

    const applyHighlight = (cell) => {
      if (getComputedStyle(cell).display !== 'none') {
        cell.classList.add('manual-highlight');
      }
    };

    // Highlight the entire row
    rows[rowIndex].querySelectorAll('td, th').forEach(applyHighlight);

    // Highlight cells with rowspan that span this row
    rows.forEach((row, rIdx) => {
      Array.from(row.cells).forEach(cell => {
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1');
        const start = rIdx;
        const end = rIdx + rowspan - 1;
        if (rowIndex >= start && rowIndex <= end) {
          applyHighlight(cell);
        }
      });
    });

    // Make the clicked time cell bold
    clickedCell.classList.add('time-highlight-active');
  }

  /**
   * Highlights the clicked artist, all other artists playing at the same time, and the time slots.
   * @param {HTMLElement} clickedCell The artist cell that was clicked.
   */
  function highlightArtistRow(clickedCell) {
    const table = document.querySelector('.waffle');
    const rows = Array.from(table.rows);
    const clickedRowIndex = rows.indexOf(clickedCell.parentElement);
    const clickedRowspan = parseInt(clickedCell.getAttribute('rowspan') || '1');
    const clickedStart = clickedRowIndex;
    const clickedEnd = clickedRowIndex + clickedRowspan - 1;

    // Make the clicked artist cell bold and slightly darker
    clickedCell.classList.add('active');

    // Find and highlight all other artists whose performance times overlap
    document.querySelectorAll('.waffle td:not(.s1)').forEach(cell => {
      const cellRow = rows.indexOf(cell.parentElement);
      const rowspan = parseInt(cell.getAttribute('rowspan') || '1');
      const cellStart = cellRow;
      const cellEnd = cellRow + rowspan - 1;

      // Check for overlap in performance times (using row spans)
      const overlap = !(cellEnd < clickedStart || cellStart > clickedEnd);
      if (overlap) {
        cell.classList.add('artist-highlight');
      }
    });

    // Highlight the corresponding time cells for the clicked artist's slot
    for (let r = clickedStart; r <= clickedEnd; r++) {
      const timeCell = rows[r].querySelector('.s1');
      if (timeCell) timeCell.classList.add('artist-highlight');
    }
  }

  // === INITIALIZATION ===
  document.addEventListener('DOMContentLoaded', () => {
    // Apply automatic highlight if it's a festival day
    if (isFestivalDay) {
      highlightCurrentTime();
      // Also, check every 30 seconds to update the highlight if the time changes
      setInterval(highlightCurrentTime, 30000);
    }

    // Add click listener for time cells (e.g., "14:00")
    document.querySelectorAll('.s1').forEach(cell => {
      cell.addEventListener('click', () => {
        const isAlreadyActive = cell.classList.contains('time-highlight-active');
        clearAllHighlights(); // Clear previous manual highlights
        if (!isAlreadyActive) {
          highlightManualTimeRow(cell); // Highlight new selection
        }
      });
    });

    // Add click listener for artist cells
    document.querySelectorAll('.waffle td:not(.s1)').forEach(cell => {
      // Only add listeners to cells that actually contain an artist name
      if (cell.textContent.trim() === '') return;

      cell.addEventListener('click', () => {
        const isAlreadyActive = cell.classList.contains('active');
        clearAllHighlights(); // Clear previous manual highlights
        if (!isAlreadyActive) {
          highlightArtistRow(cell); // Highlight new selection
        }
      });
    });
  });
</script>
</body>
</html>
